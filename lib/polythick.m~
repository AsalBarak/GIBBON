function [X1,Y1,X2,Y2]=polythick(x,y,t,nSteps,resampleFactor)

% function [Xu Yu Xl Yl]=polythick(x,y,t)
% ------------------------------------------------------------------------
% This function thickens a polygon defined by x, y. It generates the upper
% (Xu, Yu) and lower (Xl, Yl) coordinates depending on the thickness t. 
%
% The slope is calculated at each coordinate and points are copied upwards
% and downwards (thickening) orthogonal to the local slope.
%
% Kevin Mattheus Moerman
% gibbon.toolbox@gmail.com
% 27/08/2008 Created
% 2017/03/16 Updated for GIBBON

%------------------------------------------------------------------------

%% 

V_curve=[x(:) y(:)];
D=sqrt(sum(diff(V_curve,1,1).^2,2));
nSteps=ceil(4*(t./max(D)));

V_curve1=V_curve;
V_curve2=V_curve;

for q=1:1:nSteps

    [~,~,N]=polyNormal(V_curve1);
    N(:,3)=0;
    V_curve1=V_curve1-(t/2/nSteps)*N;    
    
    [~,~,N]=polyNormal(V_curve2);
    N(:,3)=0;
    V_curve2=V_curve2+(t/2/nSteps)*N;    
    
    [V_curve1] = evenlySampleCurve(V_curve1,size(V_curve,1)*resampleFactor,'linear',0);
    [V_curve2] = evenlySampleCurve(V_curve2,size(V_curve,1)*resampleFactor,'linear',0);
end

[V_curve1] = evenlySampleCurve(V_curve1,size(V_curve,1),'linear',0);
[V_curve2] = evenlySampleCurve(V_curve2,size(V_curve,1),'linear',0);

X1=V_curve1(:,1);
Y1=V_curve1(:,2);

X2=V_curve2(:,1);
Y2=V_curve2(:,2);

